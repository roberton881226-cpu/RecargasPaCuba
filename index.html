<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RecargasPaCuba</title>

<link rel="manifest" href="/RecargasPaCuba/manifest.json" />
<link rel="icon" href="icon-192.png" />
<meta name="theme-color" content="#0d63c9" />

<style>
body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: #0d1117;
    color: #fff;
}

header {
    background: linear-gradient(90deg, #27a3ff, #0d63c9);
    padding: 25px 0 35px;
    text-align: center;
    font-size: 26px;
    font-weight: bold;
    color: #fff;
}

/* NAV */
nav {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: #161b22;
    display: flex;
    border-top: 1px solid #333;
}
nav button {
    flex: 1;
    padding: 15px 0;
    background: none;
    border: none;
    color: #aaa;
    font-size: 16px;
}
nav .active {
    background: #0d63c9;
    color: #fff;
}

/* PAGE CONTAINERS */
.container { padding: 20px; margin-bottom: 90px; }

/* INPUTS */
.inputBox {
    background: #161b22;
    padding: 10px 14px;
    border-radius: 10px;
    margin-bottom: 12px;
    border: 1px solid #333;
}
.inputBox input {
    width: 100%;
    background: transparent;
    border: none;
    color: #fff;
    font-size: 18px;
    outline: none;
}

/* OPERATOR BUTTONS */
.ops {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}
.ops button {
    flex: 1;
    padding: 15px;
    border: none;
    background: #161b22;
    color: #fff;
    border-radius: 10px;
    font-size: 16px;
    border: 1px solid #333;
}
.ops .active {
    background: #0d63c9;
    border-color: #0d63c9;
}

/* PRODUCT CARDS */
.card {
    background: #161b22;
    padding: 16px;
    margin-bottom: 12px;
    border-radius: 10px;
    border: 1px solid #222;
}
.price { font-size: 20px; font-weight: bold; color: #fff; }
.desc { color: #ccc; font-size: 14px; margin: 5px 0; }
.useBtn {
    float: right;
    background: #0d63c9;
    border: none;
    padding: 8px 14px;
    border-radius: 8px;
    color: #fff;
}

/* MODAL */
#modalBg {
    position: fixed;
    top:0; left:0; width:100%; height:100%;
    background: #000a;
    display:none;
    justify-content:center;
    align-items:center;
}
#modalBox {
    background:#161b22;
    padding:20px;
    border-radius:12px;
    width:85%;
}
.modalBtn {
    width:100%;
    padding:10px 0;
    background:#0d63c9;
    border:none;
    border-radius:10px;
    color:#fff;
    font-size:18px;
    margin-top:12px;
}

/* TOAST */
#toast {
    position:fixed;
    bottom:80px;
    left:50%;
    transform:translateX(-50%);
    background:#0d63c9;
    padding:12px 20px;
    border-radius:8px;
    display:none;
}
</style>
</head>
<body>

<header>RecargasPaCuba</header>

<!-- HOME -->
<div class="container" id="view-home">
    <h2>EnvÃ­a recargas a Cuba</h2>
    <p style="color:#aaa">Elige operador, oferta y confirma.</p>

    <div class="ops">
        <button id="opCubacel" class="active">ðŸ‡¨ðŸ‡º Cubacel</button>
        <button id="opNauta">ðŸ“¶ Nauta</button>
    </div>

    <div class="inputBox">
        <input type="text" id="telefono" placeholder="+53 ___ ___ ___" maxlength="16">
    </div>

    <h3>Ofertas disponibles</h3>
    <div id="listaOfertas"></div>
</div>

<!-- HISTORIAL -->
<div class="container" id="view-history" style="display:none;">
    <h2>Historial</h2>
    <div id="listaHistorial"></div>
</div>

<!-- CUENTA -->
<div class="container" id="view-account" style="display:none;">
    <h2>Cuenta</h2>
    <p style="color:#aaa;">Modo Demo activado<br>No se envÃ­an recargas reales.</p>
</div>

<!-- NAV -->
<nav>
    <button id="nav-home" class="active">Inicio</button>
    <button id="nav-recargar">Recargar</button>
    <button id="nav-history">Historial</button>
    <button id="nav-account">Cuenta</button>
</nav>

<!-- MODAL -->
<div id="modalBg">
    <div id="modalBox">
        <h3>Confirmar Recarga</h3>
        <p id="mResumen" style="color:#ccc;"></p>
        <button class="modalBtn" id="mConfirmar">Confirmar</button>
        <button class="modalBtn" style="background:#444" onclick="cerrarModal()">Cancelar</button>
    </div>
</div>

<!-- TOAST -->
<div id="toast">Guardado en historial</div>

<script>
// PRODUCTOS
const cubacel = [
    { price:"â‚¬ 10,42", desc:"CUP 250 â€“ 1247", type:"Recarga" },
    { price:"â‚¬ 20,84", desc:"5GB + 4GB + 75min", type:"Paquete 30 dÃ­as" },
    { price:"â‚¬ 31,26", desc:"10GB + 4GB + 165min", type:"Paquete 30 dÃ­as" }
];
const nauta = [
    { price:"â‚¬ 8,12", desc:"CUP 360 saldo", type:"Recarga" },
    { price:"â‚¬ 13,53", desc:"CUP 600 saldo", type:"Recarga 30 dÃ­as" }
];

let operador = "Cubacel";
let ofertaSeleccionada = null;

// CAMBIO DE OPERADOR
opCubacel.onclick = ()=>{ operador="Cubacel"; opCubacel.classList.add("active"); opNauta.classList.remove("active"); cargarOfertas(); };
opNauta.onclick = ()=>{ operador="Nauta"; opNauta.classList.add("active"); opCubacel.classList.remove("active"); cargarOfertas(); };

// CARGAR OFERTAS
function cargarOfertas(){
    const lista = document.getElementById("listaOfertas");
    lista.innerHTML = "";
    const data = operador=="Cubacel"? cubacel : nauta;

    data.forEach((o,i)=>{
        lista.innerHTML += `
        <div class="card">
            <div class="price">${o.price}</div>
            <div class="desc">${o.desc}</div>
            <button class="useBtn" onclick="abrirConfirm(${i})">Usar</button>
        </div>`;
    });
}
cargarOfertas();

// CONFIRMACIÃ“N
function abrirConfirm(i){
    const tel = document.getElementById("telefono").value.trim();
    if(tel.length < 8){
        toast("NÃºmero invÃ¡lido");
        return;
    }

    const data = operador=="Cubacel"? cubacel : nauta;
    ofertaSeleccionada = data[i];

    mResumen.innerHTML = `
    <b>NÃºmero:</b> ${tel}<br>
    <b>Operador:</b> ${operador}<br>
    <b>Oferta:</b> ${ofertaSeleccionada.price} - ${ofertaSeleccionada.type}
    `;

    modalBg.style.display="flex";
}

function cerrarModal(){ modalBg.style.display="none"; }

// CONFIRMAR
mConfirmar.onclick = ()=>{
    guardarHistorial();
    cerrarModal();
    toast("Guardado en historial");
};

// GUARDAR HISTORIAL
function guardarHistorial(){
    const tel = telefono.value.trim();
    const h = JSON.parse(localStorage.getItem("historial") || "[]");

    h.unshift({
        fecha: new Date().toLocaleString(),
        numero: tel,
        operador,
        oferta: ofertaSeleccionada
    });

    localStorage.setItem("historial", JSON.stringify(h));
    cargarHistorial();
}

// HISTORIAL
function cargarHistorial(){
    const h = JSON.parse(localStorage.getItem("historial") || "[]");
    const box = document.getElementById("listaHistorial");
    box.innerHTML = "";

    if(h.length===0){ box.innerHTML="<p style='color:#aaa;'>VacÃ­o</p>"; return; }

    h.forEach(item=>{
        box.innerHTML += `
        <div class="card">
            <div><b>${item.numero}</b> - ${item.operador}</div>
            <div class="desc">${item.oferta.price} â€” ${item.oferta.type}</div>
            <div style="color:#555; font-size:12px;">${item.fecha}</div>
        </div>`;
    });
}
cargarHistorial();

// TOAST
function toast(msg){
    const t=document.getElementById("toast");
    t.innerText=msg;
    t.style.display="block";
    setTimeout(()=>{ t.style.display="none"; },1500);
}

// NAV
function show(id){
    document.getElementById("view-home").style.display="none";
    document.getElementById("view-history").style.display="none";
    document.getElementById("view-account").style.display="none";

    document.getElementById(id).style.display="block";

    nav-home.classList.remove("active");
    nav-recargar.classList.remove("active");
    nav-history.classList.remove("active");
    nav-account.classList.remove("active");

    document.getElementById("nav-"+id.replace("view-","")).classList.add("active");
}

nav-home.onclick = ()=>show("view-home");
nav-recargar.onclick = ()=>show("view-home");
nav-history.onclick = ()=>show("view-history");
nav-account.onclick = ()=>show("view-account");

// PWA
if("serviceWorker" in navigator){
    navigator.serviceWorker.register("/RecargasPaCuba/service-worker.js");
}
</script>

</body>
</html>

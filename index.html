<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RecargasPaCuba</title>
  <meta name="theme-color" content="#87CEEB"/>
  <link rel="manifest" href="manifest.json">

  <style>
    :root{
      --bg:#f6fbff; --card:#fff; --muted:#6b7280; --primary:#87CEEB; --accent:#0b84ff;
      --danger:#ff4d4f; --glass: rgba(255,255,255,0.7);
    }
    @media (prefers-color-scheme: dark) {
      :root{ --bg:#0b0f14; --card:#0f1720; --muted:#9aa3b2; --primary:#0ea5e9; --accent:#0b84ff;
        --glass: rgba(255,255,255,0.04);
      }
      body{color:#e6eef6}
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;background:var(--bg);color:#0b1220}

    header.appbar{
      background:linear-gradient(90deg,var(--primary),#4fc3f7);
      color:#fff;padding:18px 14px;border-bottom-left-radius:12px;border-bottom-right-radius:12px
    }
    header.appbar h1{margin:0;font-size:20px;text-align:center;letter-spacing:0.2px}

    .wrap{max-width:820px;margin:14px auto;padding:0 12px}
    .card{background:var(--card);border-radius:14px;padding:14px;margin-bottom:12px;box-shadow:0 8px 24px rgba(11,20,30,0.06)}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}

    input,select,textarea{
      width:100%;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);
      font-size:15px;background:transparent
    }

    button.btn{
      width:100%;padding:12px;border-radius:12px;border:none;background:var(--accent);
      color:#fff;font-weight:600;cursor:pointer
    }

    .row{display:flex;gap:10px}
    .row > *{flex:1}
    .muted{color:var(--muted);font-size:13px}
    .small{font-size:13px;color:var(--muted)}

    .operators{display:flex;gap:8px;align-items:center}
    .op{padding:8px 10px;border-radius:10px;background:var(--glass);display:flex;gap:8px;
      align-items:center;border:1px solid rgba(11,20,30,0.03)
    }

    .price-card{
      display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;
      border:1px solid rgba(11,20,30,0.04);margin-top:8px
    }

    .price-card button{
      padding:8px 10px;border-radius:8px;background:#fff;border:1px solid rgba(11,20,30,0.06);cursor:pointer
    }

    nav.bottom{
      position:fixed;left:0;right:0;bottom:0;padding:10px 12px;background:transparent;
      display:flex;justify-content:center;pointer-events:none
    }

    .bottom-inner{
      max-width:820px;width:100%;display:flex;gap:8px;pointer-events:auto
    }

    .tab{
      flex:1;padding:12px;border-radius:12px;background:var(--card);text-align:center;
      border:1px solid rgba(11,20,30,0.04);cursor:pointer
    }

    .active{border:2px solid var(--accent)}
    .title{font-weight:700;font-size:18px;margin-bottom:6px}

    .promo{
      background:linear-gradient(90deg,#ffecd2,#fcb69f);padding:12px;border-radius:10px;color:#3b2f1d
    }

    footer.info{
      padding:24px 12px;text-align:center;color:var(--muted);font-size:13px;margin-top:70px
    }

    @media(min-width:700px){
      .wrap{padding:0 40px}
      .card{padding:20px}
    }
  </style>
</head>

<body>

<header class="appbar">
  <h1>RecargasPaCuba</h1>
</header>

<div class="wrap">

  <!-- HOME -->
  <div class="card" id="homeCard">
    <div class="title">Recargas r√°pidas a Cuba</div>
    <div class="muted">Env√≠a saldo r√°pido. Funciona offline.</div>

    <div style="height:10px"></div>
    <div class="promo">üî• Promo demo: recarga + bonus (demo)</div>
  </div>

  <!-- RECARGAR -->
  <div class="card" id="rechargeCard" style="display:none">
    <div class="title">Enviar recarga</div>
    <div class="muted">Selecciona operador y cantidad.</div>

    <div style="height:10px"></div>

    <label for="operator">Operadora</label>
    <div class="operators">
      <div class="op">
        <select id="operator" style="border:none;background:transparent;padding:0;">
          <option value="cubacel">üá®üá∫ Cubacel</option>
        </select>
      </div>

      <div style="flex:1">
        <label for="phone">N√∫mero (53XXXXXXXXX)</label>
        <input id="phone" placeholder="53XXXXXXXXX"/>
      </div>
    </div>

    <div style="height:10px"></div>
    <label for="amount">Cantidad (USD)</label>
    <input id="amount" type="number" min="1" placeholder="10"/>

    <div class="muted" style="margin-top:10px">Precios r√°pidos</div>
    <div id="prices"></div>

    <div style="height:12px"></div>
    <button id="sendBtn" class="btn">Enviar recarga</button>
    <div id="msg" style="margin-top:10px"></div>
  </div>

  <!-- HISTORIAL -->
  <div class="card" id="historyCard" style="display:none">
    <div class="title">Historial</div>
    <div class="muted">Tus recargas guardadas.</div>
    <div id="historyList" style="margin-top:12px"></div>
  </div>

  <!-- CUENTA -->
  <div class="card" id="accountCard" style="display:none">
    <div class="title">Cuenta</div>
    <div class="muted">Modo demo</div>
  </div>

  <footer class="info">RecargasPaCuba ‚Äî Demo ¬∑ Hecho con ‚ù§Ô∏è</footer>
</div>

<!-- NAV -->
<nav class="bottom">
  <div class="bottom-inner">
    <div id="tab-home" class="tab active">Inicio</div>
    <div id="tab-recharge" class="tab">Recargar</div>
    <div id="tab-history" class="tab">Historial</div>
    <div id="tab-account" class="tab">Cuenta</div>
  </div>
</nav>

<script>
const $ = id => document.getElementById(id);
const tabs = ["home","recharge","history","account"];

tabs.forEach(t=>{
  $("tab-"+t).onclick = ()=> openTab(t);
});

function openTab(t){
  tabs.forEach(x=>{
    $("tab-"+x).classList.remove("active");
    const card = x+"Card";
    $(card).style.display = "none";
  });
  $("tab-"+t).classList.add("active");
  $(t+"Card").style.display = "block";

  if(t==="recharge") renderPrices();
  if(t==="history") renderHistory();
}


/* --- Datos --- */
const state = {
  history: JSON.parse(localStorage.getItem("rp_history") || "[]"),
  prices: [5,10,20,50]
};

function saveState(){
  localStorage.setItem("rp_history", JSON.stringify(state.history));
}

function renderPrices(){
  $("prices").innerHTML = state.prices.map(p=>`
    <div class="price-card">
      <div><strong>$${p}</strong></div>
      <button onclick="document.getElementById('amount').value=${p}">Usar</button>
    </div>
  `).join("");
}

function renderHistory(){
  const list = $("historyList");
  if(state.history.length===0){
    list.innerHTML = "<div class='small muted'>No hay recargas</div>";
    return;
  }
  list.innerHTML = state.history.map(r=>`
    <div class="price-card">
      <div>
        <strong>${r.operator}</strong><br>
        <small>${r.phone}</small>
      </div>
      <div>$${r.amount}</div>
    </div>
  `).join("");
}


/* --- Enviar --- */
$("sendBtn").onclick = ()=>{
  const phone = $("phone").value.trim();
  const amount = Number($("amount").value);

  if(!phone || phone.length<8) return msg("N√∫mero inv√°lido",1);
  if(!amount) return msg("Cantidad inv√°lida",1);

  const rec = {
    id: Date.now(),
    phone, amount,
    operator:"cubacel",
    date: new Date().toISOString()
  };

  state.history.unshift(rec);
  saveState();
  msg("Guardado (demo)");
};

function msg(t,err=0){
  $("msg").innerHTML =
    `<div style="padding:10px;border-radius:8px;background:${err?"#ffcccc":"#ccffcc"}">${t}</div>`;
  setTimeout(()=> $("msg").innerHTML="",3000);
}


/* --- Service Worker REAL --- */
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker
      .register("/service-worker.js")
      .then(() => console.log("SW registrado"))
      .catch(() => console.log("SW error"));
  });
}


/* --- Init --- */
openTab("home");
</script>

</body>
</html>
